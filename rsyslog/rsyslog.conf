module(load="imudp")
input(type="imudp" port="514")

module(load="imtcp")
input(type="imtcp" port="514")

# 输出模板：每个容器一个日志文件
$template DockerLogs,"/var/log/docker/%programname%.log"

# 过滤掉本地日志，只保存远程 docker 容器日志
if ($fromhost-ip != "127.0.0.1") then {
    action(
        type="omfile"
        dynaFile="DockerLogs"
        fileCreateMode="0644"
        dirCreateMode="0755"
    )
    stop
}
